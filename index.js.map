{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport const PICTURES_ON_PAGE = 15;\n\nconst apiKey = \"47925753-e7f436f37bf276331d4c00f65\"\naxios.defaults.baseURL = \"https://pixabay.com\"\nexport async function findImages(searchString, page=1) {\n  return await axios.get('/api/', {\n    params: {\n        key: apiKey,\n        q: searchString, // .toString().trim().replaceAll(' ', '+'),\n        pretty: true,\n        orientation: \"horizontal\",\n        safesearch: true,\n        image_type: \"photo\",\n        page: page,\n        per_page: PICTURES_ON_PAGE\n      }\n    })\n}\n","export function getPicturesHtml(picturesList) {\n    var imagesHtml = []\n    for (const {previewURL, largeImageURL, likes, views, comments, downloads, tags} of picturesList) {\n    imagesHtml.push(\n    `<div class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${previewURL}\" alt=\"${tags}\" />\n            <table class=\"description-table\">\n                <tr class=\"description-table-row table-header\">\n                    <td>Likes</td>\n                    <td>Views</td>\n                    <td>Comments</td>\n                    <td>Downloads</td>\n                </tr>\n                <tr class=\"description-table-row table-content\">\n                    <td>${likes}</td>\n                    <td>${views}</td>\n                    <td>${comments}</td>\n                    <td>${downloads}</td>\n                </tr>\n            </table>\n\n        </a>\n    </div>`)\n    }\n    return imagesHtml.join(' ')\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\"\nimport { findImages, PICTURES_ON_PAGE } from \"./js/pixabay-api\";\nimport { getPicturesHtml } from \"./js/render-function\"\n\n\nconst button = document.querySelector('.search-button');\nconst inProgress = document.querySelector('.in-progress'); //88\nconst searchString = document.querySelector('.search-string')\nconst gallery = document.querySelector('.gallery')\nconst loadMoreButton = document.querySelector('.load-more')\nlet totalCount = 0\nlet pageNumber = 1\nlet searchStringValue = ''\n\nvar lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250, captionsData: 'alt' })\n\nloadMoreButton.style.display = 'none'\n\n\nconst iziToastParameters = {\n    messageSize: \"16px\",\n    messageColor: \"#FAFAFB\",\n    backgroundColor: \"#EF4040\",    \n    iconUrl: \"https://site-assets.fontawesome.com/releases/v6.7.2/svgs/sharp-light/octagon-xmark.svg\",\n    iconColor: \"#FAFAFB\",\n    maxWidth: 432,  \n    messageLineHeight: \"24px\",\n    position: \"topRight\",\n    \n}\n\nbutton.addEventListener('click', (event) => {\n    event.preventDefault()\n    gallery.innerHTML = ''\n    setLoading()\n    pageNumber = 1\n    totalCount = 0\n    searchStringValue = searchString.value\n\n\n    findImages(searchStringValue).then((response) => {\n        if (response.status != 200) {\n            throw new Error(response.status);\n        }\n        return response\n    }).then((pictures) => {\n        setLoading()\n        totalCount = pictures.data.total\n        if(totalCount == 0){\n            inProgress.innerHTML = ``\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                ...iziToastParameters, \n            })\n        } else {\n            const picturesList = pictures.data.hits\n            const picturesHtml = getPicturesHtml(picturesList)\n            gallery.innerHTML = picturesHtml\n            showLoadMore()\n            lightbox.refresh()\n        }\n    })\n    .catch((error) => {iziToast.error({\n        title: \"Something bad happened\",\n        message: error,\n        ...iziToastParameters,\n    })\n    console.log(error)\n    showLoadMore()\n})\n    \n})\n\nfunction setLoading() {\n    loadMoreButton.style.display = 'none'\n    inProgress.innerHTML = `<span class=\"loader\"></span>`\n}\n\nfunction showLoadMore() {\n    inProgress.innerHTML = ``;\n    loadMoreButton.style.display = 'block'\n}\n\n\nloadMoreButton.addEventListener('click', (event) => {\n    \n    event.preventDefault()\n    setLoading()\n    if(totalCount <= pageNumber * PICTURES_ON_PAGE) {\n        iziToast.error({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            ...iziToastParameters, \n        })\n        inProgress.innerHTML = ``\n        return\n    } \n    else {\n        pageNumber++\n\n        findImages(searchStringValue, pageNumber)\n        .then((response) => {\n            if (response.status != 200) {\n                throw new Error(response.status);\n            }\n            return response})\n        .then((pictures) => {\n            const picturesList = pictures.data.hits\n            const picturesHtml = getPicturesHtml(picturesList)\n            gallery.insertAdjacentHTML('beforeend', picturesHtml)\n            lightbox.refresh()\n            const galleryItemElement = document.querySelector('.gallery-item')\n            const galleryItem = galleryItemElement.getBoundingClientRect()\n            const computedStyle = window.getComputedStyle(gallery);\n            const gap = parseFloat(computedStyle.gap || computedStyle.rowGap || 0)\n            window.scrollBy({\n                top: (galleryItem.height + gap) * 2,\n                behavior: \"smooth\",\n            })\n            showLoadMore()\n        })\n        .catch((error) => {\n            iziToast.error({\n                title: \"Something bad happened\",\n                message: error,\n                ...iziToastParameters,})  \n            console.log(error)\n            showLoadMore()\n        })\n\n    }\n\n})\n\n"],"names":["PICTURES_ON_PAGE","apiKey","axios","findImages","searchString","page","getPicturesHtml","picturesList","imagesHtml","previewURL","largeImageURL","likes","views","comments","downloads","tags","button","inProgress","gallery","loadMoreButton","totalCount","pageNumber","searchStringValue","lightbox","SimpleLightbox","iziToastParameters","event","setLoading","response","pictures","iziToast","picturesHtml","showLoadMore","error","galleryItem","computedStyle","gap"],"mappings":"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"}